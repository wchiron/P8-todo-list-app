!function(t){"use strict";function o(t,o){if(o=o||function(){},this._dbName=t,!localStorage[t]){localStorage[t]=JSON.stringify({todos:[]})}o.call(this,JSON.parse(localStorage[t]))}function a(t){var o=Math.floor(999999*Math.random())+1e5;if(0===t.length)return o;for(var r=0;r<t.length;r++)return t[r].id===o?a(t):o}o.prototype.find=function(t,o){if(o){var a=JSON.parse(localStorage[this._dbName]).todos;o.call(this,a.filter(function(o){for(var a in t)if(t[a]!==o[a])return!1;return!0}))}},o.prototype.findAll=function(t){(t=t||function(){}).call(this,JSON.parse(localStorage[this._dbName]).todos)},o.prototype.save=function(t,o,r){var i=JSON.parse(localStorage[this._dbName]),e=i.todos;o=o||function(){};var l=a(e);if(r){for(var n=0;n<e.length;n++)if(e[n].id===r){for(var s in t)e[n][s]=t[s];break}localStorage[this._dbName]=JSON.stringify(i),o.call(this,e)}else t.id=parseInt(l,10),e.push(t),localStorage[this._dbName]=JSON.stringify(i),o.call(this,[t])},o.prototype.remove=function(t,o){for(var a,r=JSON.parse(localStorage[this._dbName]),i=r.todos,e=0;e<i.length;e++)i[e].id==t&&(a=i[e].id);for(e=0;e<i.length;e++)i[e].id==a&&i.splice(e,1);localStorage[this._dbName]=JSON.stringify(r),o.call(this,i)},o.prototype.drop=function(t){var o={todos:[]};localStorage[this._dbName]=JSON.stringify(o),t.call(this,o.todos)},t.app=t.app||{},t.app.Store=o}(window);